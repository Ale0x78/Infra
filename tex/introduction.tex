\section{Introduction}
\label{sec:intro}

% phishing is important
Web-based phishing attacks, where a web page, through mimicking or urgency, tricks the user into submitting personal information to an attacker, have been increasing for the last 5 years~\cite{apwg}. While varying in delivery vectors, sent through email, SMS, or QR codes, phishing attacks remain successful in compromising individual accounts and enterprises. In 2021, the US Cybersecurity and Infrastructure Security Agency (CISA) warned of phishing campaigns targeting Non-governmental organizations (NGO) and government workers that smuggled the HTML and JavaScript of the phishing page through an attachment~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign}. Once an actor steals credentials, they sell them on illicit markets or leverage them to leak more data from the target. For example, in 2024, together with the Multi-State Information Sharing and Analysis Center, CISA reported that compromised former employee credentials were being used to access internal networks within the US government~\cite{ThreatActorLeverages2024}.
% JavaScript is important because of evasions

JavaScript is one of the cornerstones in evasive behavior of phishing pages. Evasions are critical for phishing pages because they extend their lifetime (delta time between deployment and discovery) and hinder follow-up analysis of the whole campaign. JavaScript allows access to privileged functionality through browser APIs, which enables the attacks to obfuscate the true purpose of the webpage and effectively identify differentiating factors when a victim or a potential analysis framework is viewing the webpage ~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}. The JavaScript logic can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls, and renders the page after confirming the victim is using a real browser. 
% Our paper

In this paper, we leverage the complexity of the JavaScript code to differentiate phishing pages via their client-side techniques. With the aid of VisisbleV8~\cite{vv8-imc19} we aquire browser API traces over half a milion pages, which we cluster using hierarchical clustering into a little over 11,000 clusters. Figure~\ref{fig:pages_clusters_per_month} shows how much the volume of the phenomena is reduced through clusters of browser API usage of pages. Overall, we offer the following contributions: 
\begin{contributions}
    \item We demonstrate that browser API usage alone is sufficient to isolate and distinguish known phishing kits. With a groundtruth dataset of 526 phishing kits that were deployed across 4,448 pages, we achive a 93\% FMI based accuracy and an 86\% V-Score accuracy in the clusters of these pages.
    \item We digest the pages observed from phishing feeds into \totalClusters{} which allows us to observe that most clusters are short lives, and target a single-barnd. This could suggest that mass phishing campaigns gravitate towards low-quality, non-modular, and cheap or free kits. We find an example of a cluster from an open-source kit that is now several years old, as well as XXX USPS pages from the same kit that we are able to extract on 40 different occasions using KitPhishr. 
    \item We shine a light on how wide-spread different technique are in the ecosystem, by anotating dynamic traces of pages within a cluster, and propogating the behavior to the cluster as a whole. We find that UI-interactivity and basic fingerprinting are near universal nowadays in phishing pages, while mouse detection via browser APIs, Cloudflare Turnstile embedding, and dynamic script creation are still relatively rare. We also note that compared to prior work, we observe a decreased ratio of pages that employ pop-ups as a form of bot-detection. 
\end{contributions}

\input{figures/clusters_per_month}

%The rest of the paper will break down the necessary background regarding the phishing ecosystem and adversarial techniques. We will go over relevant work in studying the ecosystem in Section-\ref{sec:related}. We will describe the methods we used to study the ecosystem in Section-\ref{sec:methods} and go over what we found in Section-\ref{sec:results}.
