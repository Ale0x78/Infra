\section{Introduction}
\label{sec:intro}

% phishing is important
Web-based phishing attacks, where a webpage, through mimicking or urgency, tricks the user into submitting personal information to an attacker, have been increasing for the last 5 years~\cite{apwg}. While varying in delivery vectors, sent through email, SMS, or QR codes, phishing attacks remain successful in compromising individual accounts and enterprises. In 2021, the US Cybersecurity and Infrastructure Security Agency (CISA) warned of phishing campaigns targeting Non-governmental organizations (NGO) and government workers that smuggled the HTML and JavaScript of the phishing page through an attachment~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign}. Once an actor steals credentials, they sell them on illicit markets or leverage them to leak more data from the target. For example 2024, with the Multi-State Information Sharing and Analysis Center, CISA reported that compromised former employee credentials were being used to access internal networks within the US government~\cite{ThreatActorLeverages2024}.


% Phishing 
Phishing kits, ready-to-deploy software packages sold at illicit markets for launching phishing attacks, have lowered the barrier of entry for malicious actors. Sellers often market phishing kits as bundles of quality-of-life features for attackers, such as built-in evasions from automated crawlers, exfiltration to Telegram channels, and obfuscation\cite{tejaswiLeakyKitsIncreased2022,oest_inside_2018}. Deploying these kits can be as easy as uploading them to free hosting providers and mass sending multiple links that exfiltrate the credentials to the same endpoints. 

% JavaScript is important because of evasions
One of these selling points, evasions, extends a phishing page's lifetime (delta time between deployment and discovery) and increases the number of victims visiting the page without a browser warning. While server-side logic of kits can only make assumptions about the system based on the IP address and User agent, through API calls to the browser, client-side JavaScript code can query the user's system for CPU core counts, memory overhead, request user interaction, or call out to a 3rd party bot detection like CloudFlare~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}. In the end, the JavaScript logic in a kit can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls, and renders the page after confirming the victim is using a mobile device.

% Our paper
We leverage the complexity of the page's JavaScript logic to cluster the page and further annotate the clusters with what phishing techniques they employ. This paper aims to aid researchers and analysts by automatically differentiating groups of phishing pages based on the underlying kit. Crawling phishing pages from APWG, PhishTank, OpenPhish, URLScan, and PhishingDB for \daysCrawled{}, we collect \totalPagesWithJavascriptFP{} pages with sophisticated enough JavaScript logic (\APIcutoff{} Browser APIs executed) and \totalZipFiles{} Zip files as potential phishing kits for these websites. Through SHA256 deduplication, and manual examination (Described in Section-XX), we distil this \totalNumberOfKitFamilies{} phishing kit families deployed across \totalKitPages{}.
Evaluating the crawler over this dataset of URLs and kits, we find that clustering over the set of browser APIs executed using hierarchical clustering yields a completeness score of XXX and a homogeneity score of XXX. We then turn the clustering to \totalPagesWithJavascriptFP{} pages, which we group into \totalClusters{} clusters. Figure~\ref{fig:pages_clusters_per_month} shows how the volume of pages/week can be by an order of magnitude when viewed as active clusters/week. We then use a predefined mapping of browser APIs to phishing techniques to better understand how widespread these practices are, while controlling for the mass-deployment of a single kit. For example, Client-Side IP checks occur in \textbf{19,869} pages; however, this totals to \textbf{504} clusters, and \textbf{23\%} of the pages come from a single cluster, which consists of Facebook business account phishing pages.
Overall, we offer the following contributions:
\begin{contributions}
    \item We demonstrate that \emph{browser API usage alone} is sufficient to isolate and distinguish known phishing kits. With a ground truth dataset of 526 phishing kits deployed across 4,448 pages, we achieve accuracy metrics of a 93\% Fowlkes-Mallows score and an 86\% V-measure in the clusters of these pages relative to their kits used.
    \item We experimentally demonstrate optimal parameters for this kind of clustering. We argue that browser APIs common on the web (DOM APIs, property reads, etc.) serve as a valuable identifier for identifying kits, as they signal the kit developer's choices. 
    \item We digest \totalPagesClusterable{} phishing feeds into \totalClusters{} clusters, which allows us to observe that most clusters have short lives, and target a single brand, suggesting that mass phishing campaigns gravitate towards low-quality, non-modular, and cheap or free kits. 
    \item We highlight how widespread different techniques are in the ecosystem by annotating dynamic traces of pages within a cluster and propagating the behavior to the cluster as a whole. When annotating all the clusters for the different techniques used, we find that UI-interactivity and basic fingerprinting are near-universal nowadays. At the same time, mouse detection via browser APIs, Cloudflare Turnstile embedding, and dynamic script creation are still relatively rare. We also note that compared to prior work, we observe a decreased ratio of pages that employ pop-ups as a form of bot detection.
    \item We release the dataset of ground truth labeled URLs we collected and all the clusters we observed.
\end{contributions}

% How are we different from prior work
This work stands apart from prior research, as we automatically differentiate pages via all their browser APIs executed instead of static features or pre-trained classifiers. In doing so, we achieve a much higher accuracy than prior work, of F1=39.54\% from \cite{castanoPhiKitAPhishingKit2023}. Leveraging prior work, we build a mapping of different evasion techniques (Fingerprinting, Obfuscation, CloudFlare Turnstile, Client-side IP check, etc.) that a phishing page may employ and provide an up-to-date and mass-deployment-resilient description of how widespread these are.
\input{figures/clusters_per_month}

%The rest of the paper will break down the necessary background regarding the phishing ecosystem and adversarial techniques. We will go over relevant work in studying the ecosystem in Section~\ref{sec:related}. We will describe the methods we used to study the ecosystem in Section~\ref{sec:methods} and go over what we found in Section~\ref{sec:results}.
