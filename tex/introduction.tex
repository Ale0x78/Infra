\section{Introduction}
\label{sec:intro}

% phishing is important
Web-based phishing attacks, where a webpage, through mimicking or urgency, tricks the user into submitting personal information to an attacker, have been increasing for the last 5 years~\cite{apwg}. While varying in delivery vectors, sent through email, SMS, or QR codes, phishing attacks remain successful in compromising individual accounts and enterprises. In 2021, the US Cybersecurity and Infrastructure Security Agency (CISA) warned of phishing campaigns targeting Non-governmental organizations (NGO) and government workers that smuggled the HTML and JavaScript of the phishing page through an attachment~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign}. Once an actor steals credentials, they sell them on illicit markets or leverage them to leak more data from the target. For example, in 2024, with the Multi-State Information Sharing and Analysis Center, CISA reported that compromised former employee credentials were being used to access internal networks within the US government~\cite{ThreatActorLeverages2024}.
% JavaScript is important because of evasions

JavaScript is one of the cornerstones of the evasive behavior of phishing pages. Evasions are critical for phishing pages because they extend their lifetime (delta time between deployment and discovery) and hinder follow-up analysis of the whole campaign. JavaScript allows access to privileged functionality through browser APIs, which enables the attacks to obfuscate the true purpose of the webpage and effectively identify differentiating factors when a victim or a potential analysis framework is viewing the webpage ~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}. The JavaScript logic can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls, and renders the page after confirming the victim is using a real browser. 
% Our paper
This paper aims to aid researchers and analysts by differentiating groups of phishing pages based on their behavior. We leverage the complexity of the JavaScript code to cluster the pages we observe, and annotate clusters with what phishing techniques they employ. With the aid of VisisbleV8~\cite{vv8-imc19}, we acquire browser API traces over half a million pages, which we cluster using hierarchical clustering into a little over 11,000 clusters. Figure~\ref{fig:pages_clusters_per_month} shows how much the volume of the phenomena is reduced through clusters of browser API usage of pages. We then use a predefined mapping of browser APIs to phishing techniques to better understand how widespread these practices are, while controlling for mass-deployment phenomena. Overall, we offer the following contributions:
\begin{contributions}
    \item We demonstrate that browser API usage alone is sufficient to isolate and distinguish known phishing kits. With a ground truth dataset of 526 phishing kits that were deployed across 4,448 pages, we achieve a 93\% FMI-based accuracy and an 86\% V-Score accuracy in the clusters of these pages relative to their kits used.
    \item We digest the pages observed from phishing feeds into \totalClusters{}, which allows us to observe that most clusters have short lives, and target a single brand. This could suggest that mass phishing campaigns gravitate towards low-quality, non-modular, and cheap or free kits. 
    \item We highlight how widespread different techniques are in the ecosystem by annotating dynamic traces of pages within a cluster and propagating the behavior to the cluster as a whole. This allows for a more accurate measurement of techniques in the ecosystem, for example Client-Side IP checks are present in \textbf{19,869}, however, this totals to \textbf{504} clusters, and \textbf{23\%} of the pages come from a single cluster which consits of Facebook buissness account phishing pages. We find that UI-interactivity and basic fingerprinting are near-universal nowadays in the clusters. At the same time, mouse detection via browser APIs, Cloudflare Turnstile embedding, and dynamic script creation are still relatively rare. We also note that compared to prior work, we observe a decreased ratio of pages that employ pop-ups as a form of bot detection.
    \item We release the dataset of ground truth labeled URLs we collected, along with all of the clusters we observed.\footnote{github.com/REDACTED}
\end{contributions}
% How are we different from prior work
This work stands apart from prior research, as we automatically differentiate pages via all their browser APIs executed instead of static features or pre-trained classifiers. In doing so, we achieve a much higher accuracy than prior work with 39.54\% from \cite{castano_phikita_2023}. We also examine the pages from a perspective purely on API usage, enumerating and extending the list of techniques identified by prior work.
\input{figures/clusters_per_month}

%The rest of the paper will break down the necessary background regarding the phishing ecosystem and adversarial techniques. We will go over relevant work in studying the ecosystem in Section-\ref{sec:related}. We will describe the methods we used to study the ecosystem in Section-\ref{sec:methods} and go over what we found in Section-\ref{sec:results}.
