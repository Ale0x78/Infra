\section{Introduction}
\label{sec:intro}

% phishing is important
Web-based phishing attacks, where a web page, through mimicking or urgency, tricks the user into submitting personal information to an attacker, have been increasing for the last 5 years~\cite{apwg}. While varying in delivery vectors, sent through email, SMS, or QR codes, phishing attacks remain successful in compromising individual accounts and enterprises. In 2021, the US Cybersecurity and Infrastructure Security Agency (CISA) warned of phishing campaigns targeting Non-governmental organizations (NGO) and government workers that smuggled the HTML and JavaScript of the phishing page through an attachment~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign}. Once an actor steals credentials, they sell them on illicit markets or leverage them to leak more data from the target. For example, in 2024, together with the Multi-State Information Sharing and Analysis Center, CISA reported that compromised former employee credentials were being used to access internal networks within the US government~\cite{ThreatActorLeverages2024}.
% JavaScript is important because of evasions

JavaScript is one of the cornerstones in evasive behavior of phishing pages. Evasions are critical for phishing pages because they extend their lifetime (delta time between deployment and discovery) and hinder follow-up analysis of the whole campaign. JavaScript allows access to privileged functionality through browser APIs, which enables the attacks to obfuscate the true purpose of the webpage and effectively identify differentiating factors when a victim or a potential analysis framework is viewing the webpage ~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}. The JavaScript logic can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls, and renders the page after confirming the victim is using a real browser. 
% Our paper

In this paper, we leverage the complexity of the client-side code in phishing web pages to automatically reduce the space of phishing by viewing pages at a layer of abstraction. Figure~\ref{fig:pages_clusters_per_month} shows how much the volume of the phenomena is reduced through clusters of browser API usage of pages. With a peak of over 60,000 pages in a month, this paper aims to aid researchers and analysts in automatically differentiating between collections of phishing pages from different underlying kits or standard techniques. Overall, we offer the following contributions: 
\begin{contributions}
    \item We create a phishing kit groundtruth dataset with 4,448 pages from 526 distinct kits and observe a Jaccard index-based similarity for the JavaScript APIs used of $0.011$ for pages from the same kit, and $0.916$ for pages from different kits. We find that clustering based on the distance (1 - similarity) of browser APIs used is enough to identify if two pages share a kit behind the scenes, achieving an accuracy of 92\% based on the Fowlkes-Mallows index. These clusters are more homogeneous than complete, meaning that clustering may split pages from the same kit into a few clusters, or combine two similar kits into a single cluster, but will less often break kits apart into multiple kits.
    \item By computing the density-based cluster of these pages for a 4-week window, rolling it by 2 weeks, and merging these clusters, we get \totalClusters{} total clusters for the span of \daysCrawled{} days. These clusters are very well formed with a silhouette score of 0.6. These clusters provide a dramatic reduction in space for the overall traffic observed; we find that the top 50 clusters alone account for 40.7\% of the pages in Figure~\ref{fig:pages_clusters_per_month}. We also find that the majority of the clusters are short-lived (72\%), being observed for less than a month, and map to a single brand (80\%). This could suggest that mass phishing campaigns gravitate towards low-quality, non-modular, and cheap or free kits. We find an example of a cluster from an open-source kit that is now several years old, as well as over 10,000 USPS pages from the same kit that we are able to extract on 40 different occasions using KitPhishr. 
    \item By creating an enumerated mapping of browser API to different phishing techniques, presented in Table~\ref{tab:behaviorcategories}, we identify basic user agent and cookie-based fingerprinting, and UI-interactivity to be near universal across clusters, being present in 91\% and 85\% of the clusters, respectively. We find that browser fingerprint exfiltration, obfuscation, and timing-based bot detection is present in around 1 of every 3 clusters and that compared to prior work, pop-up based obfuscation techniques have declined, and while present in low numbers on the phishing feeds, we draw attention to client-side IP reputation checking and Cloudflare Turnstile embedded clusters, both of which can potential identify scanning tools. We find that with a small number
\end{contributions}

\input{figures/clusters_per_month}

%The rest of the paper will break down the necessary background regarding the phishing ecosystem and adversarial techniques. We will go over relevant work in studying the ecosystem in Section-\ref{sec:related}. We will describe the methods we used to study the ecosystem in Section-\ref{sec:methods} and go over what we found in Section-\ref{sec:results}.
