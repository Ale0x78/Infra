\section{Introduction (1 page)}
\label{sec:intro}

Web-based phishing attacks, where a web page, through mimicking or urgency, tricks the user into submitting personal information to an attack, have been increasing for the last 5 years~\cite{apwg}. While varying in delivery vectors, sent through email, SMS, or QR codes, they remain a successful attack for compromising individual accounts and enterprises. In 2021, the Cybersecurity and Infrastructure Security Agency (CISA) warned of phishing campaigns targeting NGOs and government workers which smuggled the HTML and Javascript of the phishing page through an attachment~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign}. Once an actor steals credentials, they sell them on illicit markets or leverage them to leak more data from the target, for example in 2024, joined with the Multi-State Information Sharing and Analysis Center, CISA reported that compromised former employee credentials were being used to access internal networks within the US government~\cite{ThreatActorLeverages2024}.

Client-side javascript is a keystone in this profitable and effective family of attacks. This highly dynamic language, which has access to privileged functionality through browser APIs, enabled the attacks to obfuscate the true purpose of the web page (HTML/CSS and the javascript code itself) and effectively identify settings when a victim or a potential analysis framework is viewing the web page ~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}.\todowrite{Someone please tell me to re-write this sentence} The javascript logic can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls and renders the page after confirming the victim is using a real browser. 
% The ability to distill information about the user via the browser's capabilities is referred to as browser fingerprinting. Prior work has studied it in both phishing and web-based advertising settings. 

\todowrite{Need a punch line here}We have crawled five phishing feeds for \daysCrawled{} days to answer the following research questions.
\begin{questions}
    \item \textbf{How indicative is a page's browser API trace of the underlying phishing kit? What differences do we see between the kits?} Having collected 4,448 pages from 526 distinct kits, we find that clustering based on the distance of browser APIs used is enough to identify if two pages share a kit behind the scenes, achieving an accuracy of 92\% based on Fowlkes-Mallows index.  \label{itm:Q1}
    \item \textbf{What does the clustering of all phishing pages collected look like?} \label{itm:Q2}
    By computing the density based cluster of these pages for a 4-week window, rolling it by 2 weeks, and merging these clusters by threshold of common pages, we get \totalClusters{} total cluster for the span of \daysCrawled{} days. These clusters are very well formed with a silhouette score of 0.6.

    % \item \textbf{Over time, how does the usage of APIs change in phishing pages? Do phishing pages adopt emerging and experimental browser APIs?} We find experimental browser APIs (not implemented by all major browsers) present in no more than 2\% of the pages we've seen. These APIs are used for both cloaking (bot-detection and fingerprinting) and mimicking (accurately copying the victim's battery percentage). We find that 405 browser APIs exhibit change patterns in 46\% of these APIs, showing a decrease, and 43\% being a spike in daily traffic observed, signaling that adoption of new APIs is far less common by the ecosystem as a whole. \label{itm:Q3}
    
    \item \textbf{What behaviors are common, rare, or kit specific in the phishing ecosystem?} By creating an enumerated mapping of browser API to different phishing techniques, presented in Table-\ref{tab:behaviorcategories}, we identify basic user agent and cookie based fingerprinting, and UI-interactivity to be near universal across clusters, being present in 91% and 85% of the clusters respectively. We find that browser fingerprint exfiltration, obfuscation, and timing based bot detection is present present in around 1 of every 3 clusters and that compared to prior work, pop-up based obfuscation techniques have declined, and while present in low numbers on the phishing feeds, we draw attention to client-side IP reputation checking and Cloudflare Turnstile embedded clusters, both of which can potential identify research infrastructure like ours. \label{itm:Q3}
\end{questions}

Figure-\ref{fig:pages_per_month} shows the monthly total of pages we have crawled through this experiment. With a peak of over 60,000 pages in a month, the goal of this paper is to aid researchers and analysts in automatically differentiating between collections of phishing pages from different underlying kits or common techniques. We then leverage the clusters we construct ontop of this data in order to study how wide-spread are different techniques at a cluster level within the phishing ecosystem, painting a better picture about the ecosystem as a whole. \todowrite{Words...Words...Words?}

\input{figures/pages_per_month.tex}
The rest of the paper will breakdown the necessary background regarding the phishing ecosystem and adversarial techniques, we will go over relevant work in studying the ecosystem in Section-\ref{sec:related}. We will describe the methods we used to study the ecosystem in Section-\ref{sec:methods} and go over what we found in Section-\ref{sec:results}.
    