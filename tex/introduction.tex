\section{Introduction (1 page)}
\label{sec:intro}

Web-based phishing attacks, where a web page, through mimicking or urgency, tricks the user into submitting personal information to an attacker, have been increasing for the last 5 years~\cite{apwg}. While varying in delivery vectors, sent through email, SMS, or QR codes, phishing attacks remain a successful attack for compromising individual accounts and enterprises. In 2021, the US Cybersecurity and Infrastructure Security Agency (CISA) warned of phishing campaigns targeting Non-governmental organizations (NGO) and government workers that smuggled the HTML and JavaScript of the phishing page through an attachment~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign}. Once an actor steals credentials, they sell them on illicit markets or leverage them to leak more data from the target. For example, in 2024, together with the Multi-State Information Sharing and Analysis Center, CISA reported that compromised former employee credentials were being used to access internal networks within the US government~\cite{ThreatActorLeverages2024}.

One of the cornerstones in evasive behavior of phishing pages, with aids in extending their lifetime (delta time between deployment and discovery) and hinders follow-up analysis of the whole campaign is JavaScript. A highly dynamic language, which has access to privileged functionality through browser APIs, which enables the attacks to obfuscate the true purpose of the web page (HTML/CSS and the javascript code itself) and effectively identify settings when a victim or a potential analysis framework is viewing the web page ~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}. The JavaScript logic can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls, and renders the page after confirming the victim is using a real browser. 

In this paper, we leverage this complexity to automatically reduce the space of phishing by viewing pages at a layer of abstraction. Figure-\ref{fig:pages_clusters_per_month} shows the monthly total of pages we have crawled through this measurement. With a peak of over 60,000 pages in a month, this paper aims to aid researchers and analysts in automatically differentiating between collections of phishing pages from different underlying kits or common techniques. Figure-\ref{fig:pages_clusters_per_month} also shows the same crawl period as viewed on a per-cluster basis. We then leverage the clusters we construct on top of this data to study how widespread different techniques are at a cluster level within the phishing ecosystem, painting a better picture of the ecosystem as a whole. This provides a different unit of measurement to view the ecosystem with, as an evasive behavior (for example, dynamic script creation) can come from over 5,000 pages; however, it mostly maps to the same 3 clusters, as is the case in our data.

We have crawled five phishing feeds for \daysCrawled{} days to answer the following research questions.
\begin{questions}
    \item \textbf{How indicative is a page's browser API trace of the underlying phishing kit?} Having collected 4,448 pages from 526 distinct kits, we find that clustering based on the distance of browser APIs used is enough to identify if two pages share a kit behind the scenes, achieving an accuracy of 92\% based on the Fowlkes-Mallows index.  These clusters are more homogeneous then complete, meaning that clustering may split pages from the same kit into few clusters, or combine kits two kits into a single cluster, but will less often break kits appart into multiple kits.\label{itm:Q1}
    \item \textbf{What does the clustering of all phishing pages collected look like?} \label{itm:Q2}
    By computing the density-based cluster of these pages for a 4-week window, rolling it by 2 weeks, and merging these clusters, we get \totalClusters{} total clusters for the span of \daysCrawled{} days. These clusters are very well formed with a silhouette score of 0.6. These clusters provide a dramatic reduction in space for the overall traffic observed; we find that the top 50 clusters alone account for 40.7\% of the pages in Figure-\ref{fig:pages_clusters_per_month}. We also find that the majority of the clusters are short-lived (72\%), being observed for less than a month, and map to a single brand (80\%).

    % \item \textbf{Over time, how does the usage of APIs change in phishing pages? Do phishing pages adopt emerging and experimental browser APIs?} We find experimental browser APIs (not implemented by all major browsers) present in no more than 2\% of the pages we've seen. These APIs are used for both cloaking (bot-detection and fingerprinting) and mimicking (accurately copying the victim's battery percentage). We find that 405 browser APIs exhibit change patterns in 46\% of these APIs, showing a decrease, and 43\% being a spike in daily traffic observed, signaling that adoption of new APIs is far less common by the ecosystem as a whole. \label{itm:Q3}
    
    \item \textbf{What techniques are common, rare, or kit-specific in the phishing ecosystem?} By creating an enumerated mapping of browser API to different phishing techniques, presented in Table-\ref{tab:behaviorcategories}, we identify basic user agent and cookie-based fingerprinting, and UI-interactivity to be near universal across clusters, being present in 91\% and 85\% of the clusters respectively. We find that browser fingerprint exfiltration, obfuscation, and timing based bot detection is present present in around 1 of every 3 clusters and that compared to prior work, pop-up based obfuscation techniques have declined, and while present in low numbers on the phishing feeds, we draw attention to client-side IP reputation checking and Cloudflare Turnstile embedded clusters, both of which can potential identify research infrastructure like ours. \label{itm:Q3}
\end{questions}

\input{figures/clusters_per_month}
The rest of the paper will breakdown the necessary background regarding the phishing ecosystem and adversarial techniques, We will go over relevant work in studying the ecosystem in Section-\ref{sec:related}. We will describe the methods we used to study the ecosystem in Section-\ref{sec:methods} and go over what we found in Section-\ref{sec:results}.
    