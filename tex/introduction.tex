\section{Introduction}
\label{sec:intro}

% phishing is important
Web-based phishing attacks, where a webpage, through mimicking or urgency, tricks the user into submitting personal information or handing over access to a machine to an attacker, have been increasing for the last 5 years~\cite{apwg,CISA}. Phishing attacks can have high-profile targets, like the NGOs and government workers targeted in 2021~\cite{intelligenceNewSophisticatedEmailbased2021,SophisticatedSpearphishingCampaign} and lead to more sophisticated cyberattacks and data breaches~\cite{ThreatActorLeverages2024}. Phishing kits, ready-to-deploy software packages sold at illicit markets for launching phishing attacks, have lowered the barrier of entry for malicious actors. Sellers often market phishing kits as bundles of quality-of-life features for attackers, such as built-in evasions from automated crawlers, exfiltration to Telegram channels, and obfuscation\cite{tejaswiLeakyKitsIncreased2022,oest_inside_2018}. Deploying these kits can be as easy as uploading them to free hosting providers and mass sending multiple links that exfiltrate the credentials to an endpoint controlled by the attacker. As phishing kits receive software updates from the original developer or the phishers who bought them, they split into variations belonging to the same ``phishing kit family''.

% JavaScript is important because of evasions
One of the selling points of phishing kits is evasion from researchers and analysts, extending the time between deployment and discovery, and increasing the number of victims visiting the page without a browser warning. While server-side logic of kits can only make assumptions about the system based on the IP address and user agent, through API calls to the browser, client-side JavaScript code can query the user's system for CPU core counts, memory overhead, request user interaction, or call out to a third party bot detection like CloudFlare\footnote{Similar to the phishing page that stole credentials from Troy Hunt, the maintainer of HaveIBeenPwned\cite{SneakyPhishJust2025}}~\cite{zhangCrawlPhishLargescaleAnalysis2021,zhangImSPARTACUSNo2022}. In the end, the JavaScript logic in a kit can range from a simple user-agent-based redirection to an AES-encrypted script that dynamically decrypts itself, identifies the browser through a series of API calls, and renders the page after confirming the victim is using a mobile device. 

% Our paper
This paper aims to aid researchers and analysts by automatically differentiating groups of phishing pages based on the pages' JavaScript behaviors. This automates a previously manual process and enables us to measure the popularity of different client-side techniques across these groups. Figure~\ref{fig:pages_clusters_per_month} shows the relative difference in volume of phishing domains compared to the number of clusters monthly active.
We focus on the following 10 techniques employed by phishing pages: fingerprint exfiltration, client-side IP check, timing-based bot detection, encoding-based obfuscation, dynamic script execution, basic fingerprint, dynamic script injection, Cloudflare turnstiles, and pop-ups. These techniques harvest credentials\cite{sanchez-rolaRodsLaserBeams2023}, evade crawlers\cite{zhang_crawlphish_2021,oestPhishFarmScalableFramework2019}, or obfuscate code to avoid analysis\cite{jsobf-imc20,fv8-sec24}, all of which are sought-after capabilities of phishing kits\cite{oest_inside_2018}. 

By clustering pages based on their browser API usage, we construct groups of pages based on a shared set of techniques. Evaluating these groups over a ground truth dataset of URLs to kit-family mappings, we find that clustering over the set of browser APIs executed yields an FMI-based accuracy of \gtFMI{} (69\% with a rebalanced ground truth) and a validity score of \gtVS{}. We then turn the clustering approach to \totalPagesWithJavascriptFP{} pages, which we group into \totalClusters{} clusters. 

This work stands apart from prior research, because we automatically differentiate pages using features from dynamic instead of static analysis. As these features are tied to capabilities a prospective kit buyer is looking for, they are less likely to vary between different deployments of the same kit family. Compared to the prior attempt at kit identification\cite{castanoPhiKitAPhishingKit2023}, of $F_1=9.03\%$ and $F_1=31.11\%$ with DOM clustering and URL path-based signatures, respectively, we achieve a much higher FMI of \gtFMI{}.

Overall, we offer the following contributions:

\begin{contributions}
    \item We find that \emph{browser API usage alone} is sufficient to isolate and distinguish known phishing kit families. With a ground truth dataset of \totalNumberOfKitFamilies{} kit families deployed on \totalKitPages{} URLs, we achieve accuracy metrics of a \gtFMI{} Fowlkes-Mallows score (69\% when rebalanced for a single-instance of a mass-deployed kit) and an \gtVS{} V-measure in the clusters of these pages relative to their kits used.
    \item We experimentally show that browser APIs common on the web (DOM APIs, property reads, etc.) serve as a valuable identifier for identifying kits, as they signal the kit developer's choices, and that the more sophisticated a page's client-side logic is, the more indicative it is of the underlying kit.
    \item On the unlabeled dataset, by propagating techniques from member pages to the cluster as a whole, we find that UI-interactivity and basic fingerprinting are near-universal in the ecosystem. At the same time, mouse detection via browser APIs, Cloudflare Turnstile embedding, and dynamic script creation are still relatively rare. While we observe client-Side IP checks occur in \clientcheckPages{} pages they spanned across \clientcheckCluster{} clusters, and \clientcheckTopClusterPrecent{} of the pages come from a single cluster, which consists of Facebook business account phishing pages. We also find that compared to prior work, there is a decreased ratio of pages that employ pop-ups as a form of bot detection. 
    \item We release a dataset of \totalKitPages{} phishing pages labeled with their underlying kit and an unlabeled dataset of browser APIs executed on over 1.3 million pages.
\end{contributions}

% How are we different from prior work

\input{figures/clusters_per_month}
