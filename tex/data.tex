\section{Data characterization} 
\label{sec:data}
This paper utilizes two distinct datasets. Labeled dataset of phishing pages deployed in the wild, their corresponding phishing kit, and an unlabeled dataset of phishing pages.

\subsection{Labeled dataset}
The ground truth data for this paper is a mapping of \totalNumberOfKitFamilies{} kit families to \totalKitPages{} phishing pages. We collected \totalZipFiles{} archive files by running all \totalPagesWithJavascriptFP{} through \kp. Only two were encrypted, which we treated as unique kits based on their SHA256 hash. We further filtered the archive files by ensuring they contained at least a single code file, as Magika\cite{fratantonio25:magika} identified. This reduces our archive count to \totalNumberOfKits{}. Finally, we group these kits into \totalNumberOfKitFamilies{} families, \kitsToReview{} pairs of kits having to be manually inspected. The most deployed kit was ``2e94aff28a2c'' (1,073 URLs), which made use of 3 seperate server-side blocklists (.httaccess file and two seperate PHP modules with regex rules for user-agent and IPs) and called 52 distinct browser APIs. The kit obtained throughout 545 days of the crawling (from 256 distinct urls) was ``fce61e98018d'', a USPS phishing kit which executed on average 170 distinct APIs, with server-side and client-side IP checks, advance fingerprinting API calls, obfuscation, and javascript generated DOM (Vite). 

In line with prior work, 89\% of these phishing kits were written in PHP, and we found 11 contained Python code. During our manual analysis of these kits, we concurred with prior work that many of these kits reused each other's code, especially regarding server-side IP blocklists. We found two module-like anti-bot detection files frequently redistributed across kits.

\paperFinding{Phishing pages from different kit families have vastly different browser API usage} Pages from different kits have an average API similarity of 15.9\% ($\sigma=0.2$). On the other hand, we find that the pages from the same kit family on average have an API similarity of 98.6\% ($\sigma=0.1$).

\subsection{Unlabeled Phishing pages}
\input{figures/example_embedding.tex}
In total, we crawled for \daysCrawled{} days, collecting browser traces from \totalPages{} urls (\totalPhishingDomains{} domains). These included false Facebook suspension, USPS mail delivery, tech support scam, and AT\&T login pages, and more. All the pages collected have been labeled as phishing, as they pose as a trustworthy entity to gain credentials or network access from their victims, despite their varying tactics and credentials collected\cite{CISA}. 
Only \totalPagesWithJavascriptFP{} qualified for clustering by executing at least 8 JavaScript APIs in a first-party context. 451,634 pages did not execute any APIs in the first-party context, and only \totalPagesClusterable{} executed at least 8 APIs to qualify for clustering. We first processed the pages into 36,708 local clusters. Figure~\ref{fig:localClusters} shows the distribution of the silhouette score of these local clusters. With an average score of 0.8, these clusters are well-formed. Once clustered together, the average cluster in our dataset contained 49 pages ($\sigma=483$), existed for 101 days ($\sigma=169$), and executed 56 ($\sigma=54$) APIs.
\input{figures/median_distance_of_clusters.tex}

We remove \badClustersPages{} pages out of the clustering, as they formed ``malformed clusters'', clusters with fewer then 2-APIs in common between all pages, this was done to avoid miss-characterization of different technique across the ecosystem. In addition to these, Cluster-``31885032'', by far the largest by page count is excluded from our evaluation, as it mainly comprised of CloudFlare notices stating ``sorry, you have been blocked'', mixed with pages that dynamically generate their frontend.

After manually inspecting a sample of clusters, we observed that these clusters have unique pages across deployment types (AWS, Cloudflare, DigitalOcean, etc.) and languages. For example, Cluster-53d5c420 comprises 483 pages across five unique e2TLDs and contains pages engaging in voice-based phishing attacks (tech support scams), varying phone numbers and error messages in each, shown in Figure~\ref{fig:ms_defender}. With over 57 APIs in common, it is clear that these pages' usage of keyboard intercepting APIs, Audio APIs, and Network APIs calls (to ipwho.is) for IP intelligence caused the pages to cluster together.

Figure~\ref{fig:example2} shows two different clusters where pages have different DOM elements or landing pages being grouped, with example screenshots pulled from both. One cluster is from a deployment we can tie to a public GitHub repository (discussed in Finding-11), and the other is a collection of crypto-wallet targeting pages. The figure shows a t-distributed stochastic neighbor (t-SDN) embedding for the distance matrix between all the pages from the two clusters to illustrate better how the pages are separated.  