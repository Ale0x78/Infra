\section{Data characterization} 
\label{sec:data}
This paper utilizes two distinct datasets. Labeled dataset of phishing pages deployed in the wild, their corresponding phishing kit, and an unlabeled dataset of phishing pages.

\subsection{Labeled dataset}
The ground truth data for this paper is a mapping of \totalNumberOfKits{} kit families to \totalKitPages{} phishing pages. We collected \totalZipFiles{} archive files from these feeds in total. Only two were encrypted, which we treated as unique kits based on their SHA256 hash. We further filtered the archive files by ensuring they contained at least a single code file, as Magika\cite{fratantonio25:magika} identified. This reduces our archive count to \totalNumberOfKits{}.
Finally, we group these kits into \totalNumberOfKitFamilies{}, \numReviewers{} manually reviewed \pairsReviews{} pairs of kits which had a file similarity between 10-80\%. 

In line with prior work, 89\% of these phishing kits were written in PHP; and we found 11 contained Python code. During our manual analysis of these kits, we concurred with prior work that many of these kits reused each other's code, especially regarding server-side IP blocklists. We found two module-like anti-bot detection files frequently redistributed across kits.

\paperFinding{Phishing pages from different kit families have vastly different browser API usage} Pages from different kits have an average API similarity of 8.5\% ($\sigma=13.7$). Figure~\ref{fig:intra_kit_sim} shows the distribution of \ji-based similarity between pages from the same kit versus different kits. On the other hand, 

\subsection{Unlabled Phishing pages}
In total, we crawled for \daysCrawled{} days collecting browser traces from \totalPageWithJavascript{} pages, out of which only \totalPagesWithJavascriptFP{} qualified for clustering by executing at least 8 JavaScript APIs in a first-party context. Before the 2nd DBSCAN merge of the 36,708 local clusters, Figure~\ref{fig:localClusters} shows the distribution of the silhouette score of the local clusters. With an average score of 0.8, these clusters are well formed. Once clustered together, the silhouette score of the final clusters was 0.5. The average cluster in our dataset contained 49 pages ($\sigma=483$), existes for 101 days ($\sigma=169$). and executes 56 ($\sigma=54$) apis.
\input{figures/median_distance_of_clusters.tex}

After manually inspecting a sample of clusters, we observed that these clusters have unique pages across deployment types (AWS, Cloudflare, DigitalOcean, etc.) and languages. For example, Cluster-53d5c420 comprises 483 pages across five unique e2TLDs and contains pages engaging in voice-based phishing attacks (tech support scams) varying phone numbers and error messages in each, shown in Figure~\ref{fig:ms_defender}. With over 57 APIs in common, it is clear that these pages' usage of keyboard intercepting APIs, Audio APIs, and Network APIs calls (to ipwho.is) for IP intelligence caused the cluster to be formed.

\input{figures/example_embedding.tex}
To show how the distance based on the \ji{} seperated different pages in the larger clusters, Figure~\ref{fig:example2} shows two different clusters, with example screenshots pulled from both. One cluster is from a deployment we can tie to a public GitHub repository (discussed in Finding-11), and the other is a collection of crypto-wallet targeting pages. The figure shows a t-distributed stochastic neighbor (t-SDN) embedding for the distance matrix between all the pages from the two clusters to illustrate better how the pages are separated.  