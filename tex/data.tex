\section{Data characterization} 
\label{sec:data}
This paper utilizes two distinct datasets. Labeled dataset of phishing pages deployed in the wild, their corresponding phishing kit, and an unlabeled dataset of phishing pages.

\subsection{Labeled dataset}
The ground truth data for this paper is a mapping of \totalNumberOfKitFamilies{} kit families to \totalKitPages{} phishing pages. We collected \totalZipFiles{} archive files by running all \totalPagesWithJavascriptFP{} through \kp. Only two were encrypted, which we treated as unique kits based on their SHA256 hash. We further filtered the archive files by ensuring they contained at least a single code file, as Magika\cite{fratantonio25:magika} identified. This reduces our archive count to \totalNumberOfKits{}. Finally, we group these kits into 2,00 families, out of which \totalNumberOfKitFamilies{} were deployed on at least two distinct URLs. The most deployed kit was ``2e94aff28a2c'', a Wells-Fargo targeting kit (1,073 URLs), which made use of 3 separate server-side blocklists (.htaccess file and two separate PHP modules with regex rules for user-agent and IPs) and called 52 distinct browser APIs. Another kit of interests was seen throughout 545 days of the crawling (from 256 distinct urls) was ``fce61e98018d'', a USPS phishing kit which executed on average 170 distinct APIs, with server-side and client-side IP checks, advance fingerprinting API calls, obfuscation, and \js generated DOM (Vite). 

In line with prior work, 89\% of these phishing kits were written in PHP, and we found 11 contained Python code. During our manual analysis of these kits, we concurred with prior work that many of these kits reused each other's code, especially regarding server-side IP blocklists. We found two module-like anti-bot detection files frequently redistributed across kits.

\paperFinding{Phishing pages from different kit families have vastly different browser API usage} Pages from different kits have an average API similarity of 15.9\% ($\sigma=0.2$). On the other hand, on average, the pages from the same kit family have an API similarity of 98.6\% ($\sigma=0.1$).

\subsection{Unlabeled Phishing pages}
\input{figures/example_embedding.tex}
In total, we crawled for \daysCrawled{} days (2023-08-19 to 2025-01-17), collecting browser traces from \totalPages{} URLs. These included false Facebook suspension, USPS mail delivery, tech support scam, AT\&T login pages, and Bitcoin Wallet logins. All the pages collected have been labeled as phishing, as they pose as a trustworthy entity to gain credentials or network access from their victims, despite their varying tactics and credentials collected\cite{CISA}. 
388,536 pages did not execute any APIs in the first-party context, and only \totalPagesClusterable{} executed at least 8 APIs in a first-party context to qualify for clustering. We first processed the pages into 27,833 local clusters. Figure~\ref{fig:localClusters} shows the distribution of the silhouette score of these local clusters. With an average score of 0.83, these clusters are well-formed. Once clustered together, the average cluster in our dataset contained 48 pages ($\sigma=468$), existed for 40 days ($\sigma=77$), and the intersection of API sets of all member pages had 63 ($\sigma=57$) APIs in common. We remove \badClusters{} local-clusters from the merge algorithm, as they formed ``malformed clusters'' with fewer than 4-APIs in common between all pages. 

After manually inspecting a sample of clusters, we observed that these clusters have unique pages across deployment types (AWS, Cloudflare, DigitalOcean, etc.) and languages. For example, Cluster-e325887b (shown in Figure~\ref{fig:ms_defender}) comprises 487 pages across five unique e2TLDs and contains pages engaging in voice-based phishing attacks in Japanese, English, and German, varying phone numbers, and error messages. With over 57 APIs in common, it is clear that these pages' usage of keyboard intercepting APIs, Audio APIs, and Network APIs calls (to ipwho.is) for IP intelligence caused the pages to cluster together.

Figure~\ref{fig:example2} shows two different clusters where pages have different DOM elements or landing pages being grouped, with example screenshots pulled from both. One cluster is from a deployment we can tie to a public GitHub repository, and the other is a collection of crypto-wallet targeting pages. The figure shows a t-distributed stochastic neighbor (t-SDN) embedding for the distance matrix between all the pages from the two clusters.