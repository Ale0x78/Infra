
\section{Results} 
\label{sec:results}

In this section, we will evaluate our clustering approach against the ground truth, inspect the distribution of ground truth pages in the final clusters, and report temporal patterns and the commonality of phishing behaviors across those clusters. In total, we crawled for \daysCrawled{} days collecting browser traces from \totalPageWithJavascript{} pages, out of which only \totalPagesWithJavascriptFP{} qualified for clustering by executing at least 8 JavaScript APIs. Furthermore, 99,464 pages were clustered as noise by HDBSCAN or formed a cluster where all the pages had no common APIs. As shown in Figure~\ref{fig:pages_clusters_per_month}, in contrast to the number of pages we observe monthly, we can substantially reduce the scope of the phishing ecosystem based on common behaviors. 

\subsection{Characteristics of clusters}

\paperFinding{Pages from different kits employ vastly different APIs} Figure~\ref{fig:intra_kit_sim} shows the distribution of Jecard-based similarity between pages from the same kit versus different kits. We observe that pages from different kits, even ones with similar themes, rarely exceed 60\% similarity,  while most pages with the same kit have around 90-100\% similarity. We leverage this in our clustering by treating $1 - JI(A,B)$ as a distance kernel of HDBSCAN. 
\input{figures/intra_kit_sim.tex}
\input{figures/example_embedding.tex}

\paperFinding{Browser API usage identify phishing kits apart from each-other}Clustering pages from \totalKitPages{} pages across \totalKits{} kits, yield \totalKitClusters{} clusters. Evaluating these clusters against the ground truth labels for each page, we find that our clusters have an FMI-based accuracy of \gtFMI{}. The clusters have a V-Score of \gtVS{}, which increases with a higher $\beta$, meaning the clusters are homogeneous. In the ground truth data, this resolves into clusters comprising a few kits being mixed together, as opposed to pages from the same kit being split across multiple clusters. In the larger clusters, we find that this results in pages that appear to be from the same kit forming 3-4 clusters. 

Pages with ground truth labels for originating kits remain appropriately sorted out in clustering the \totalPagesClusterable{} pages. We maintain an FMI of 0.95 and a V-Score of 0.89, respectively.
After manually inspecting the clusters, we observed that these clusters have unique pages across deployment types (AWS, Cloudflare, DigitalOcean, etc.) and languages. For example, Cluster-e325887b comprises 487 pages across five unique e2TLDs and contains pages engaging in voice-based phishing attacks (tech support scams) across Japanese, English, and German, varying phone numbers and error messages in each, shown in Figure~\ref{fig:ms_defender}. With over 400 APIs in common, it is clear that these pages' usage of keyboard intercepting APIs, Audio APIs, and Network APIs for IP intelligence caused the cluster to be formed. Figure~\ref{fig:example2} shows two different clusters, with example screenshots pulled from both. One cluster is from a deployment we can tie to a public GitHub repository (discussed in Finding-11), and the other is a collection of crypto-wallet targeting pages. The figure shows a t-distributed stochastic neighbor (t-SDN) embedding for the distance matrix between all the pages from the two clusters to illustrate better how the pages are separated.  


% Ignoring some types of APIs, reduces the number of pages you can cluster, while not impacting the FMI or V-Score
\paperFinding{DOM APIs and property accesses play an essential role in identifying the underlying kit} With browser APIs, feature reduction becomes an obvious goal. However, removing DOM-related APIs or property reads out of consideration drastically reduces the number of pages we can consider for ground truth evaluation, without increasing our overall accuracy. Evaluated our same methodology described in Section-\ref{sec:methods} with all HTML-DOM, SVG, and CSS APIs removed and observed FMI-based accuracy of 0.93 and V-Score of 0.86. When all property reads were removed (which are often used in fingerprinting~\cite{jsufp}), we saw FMI and V-Score of 0.93 and 0.85, respectively. In both cases, we can cluster fewer pages and thus identify fewer kits. Figure~\ref{fig:localClusters} shows the distribution of the silhouette score of the local clusters. With an average score of 0.8, these clusters are incredibly well formed and, on average, pages inside a cluster contain 64 APIs in common. 
\input{figures/median_distance_of_clusters.tex}
% Finally, to ensure that the distance metric is sufficient to isolate pages from different kits in most cases, we attempt to cluster all XXX pages from YYY kits, even if we only observed a single page from that kit. Allowing HDBSCAN to form singleton clusters, we see that these pages can still be differentiated from one another with an FMI of XXXX and V-Score of YYYY.
% We will discuss this later in the discussion, but it should be noted that we aggregate pages across different languages and deployment infra

\paperFinding{Majority of clusters map to a single brand} 80\% of clusters contain urls only marked by a single target brand by our threat intel sources\footnote{We did not include clusters in this count that had no brand-labeled urls in them}. 534 clusters (15\%) had two brand labels. However, the most popular combination of these was "Meta/Facebook", "National Police Agency JAPAN/Facebook", and "Facebook/Instagram", keeping the parent organization of the target the same in the majority of the cases. Manual examination of clusters with "National Police Agency JAPAN/Facebook" brand labels revealed shopping pages in Japanese to be marked with that label incorrectly from our data feeds. The cluster with the most diverse set of brand labels had 14 unique brand labels, which was a cluster with 12,467 pages with simple sign-in pages that exfiltrated information using client-side registered event listeners to exfiltrate data using client-side JavaScript.  Furthermore, we find that 16,100 pages (3\% of the pages observed spanning 313 clusters) come from phishing kits collected using Kitphisher; however, we could not pull the kit from the URL in all pages. 

\subsection{Temporal patterns of clusters}

\paperFinding{Majority of phishing pages originate from the top 50 clusters}
\totalFromTop{} pages of pages that executed JavaScript in a first-party context (\totalPagesWithJavascriptFP{}) are sorted into one of the 50 top clusters. The 10 clusters by page count are 20.8\% of the total pages alone. We provide a breakdown of these clusters along with manual labeling of what campaigns they correspond to in Figure~\ref{fig:top_10_clusters}. We note that one of the clusters, which we labeled dynamically generated, turned out to be a noisy cluster of simple pages that dynamically generate part of their page, without any sophisticated client-side behavior. The E-commerce cluster shown in Figure~\ref{fig:top_10_clusters} has a significant seasonality as lags 7, 14, and 21, meaning the appearance of the clusters on the feeds happens every week. However, further investigation showed that the majority of seasonal clusters are similar e-commerce phishing clusters, with vastly different dynamic behavior, allowing us to conclude that the seasonalality in the majority of the clusters is due to regular reporting by threat-intelligence sources to our feeds, and not seasonal deployments of kits.

\paperFinding{72\% of the clusters (144,695 pages), are only seen for a single month by phishing feeds} 15\% of the clusters (14,555 pages) we observe are only seen for one day, along which were brandless bank pages, and phishing page impersonating the government of Korea. Meanwhile, 1,282 clusters (11\%) have lifetimes longer than 100 days. Some clusters with a lifetime greater than 100 days still only deploy a few pages (less than 1 page every 10 days). We use this as a heuristic to identify 251 clusters 're-emergence' through our observation period. It should be noted that every day, there is a new cluster that appear on the phishing feeds based on behaviors, however, from Figure~\ref{fig:pages_clusters_per_month}, the total number of clusters active on all of our phishing feeds is much more manageable, especially when considered that the clusters can be queried based on their dynamic behaviors.  

\subsection{Phishing Techniques across clusters}

% UI interactivity is a dominant behavior!
\paperFinding{UI interactivity and fingerprinting are a near-universal behavior across clusters} Multi-stage phishing pages are very well documented in prior work, and we find that the majority of clusters (91\%) register a click event listener using JavaScript. Though this could be as simple as submitting credentials using JavaScript, this highlights the need for researchers to augment their crawlers in the future to extract better and more complete execution traces from websites. As mentioned in Section-\ref{sec:methods}, we split fingerprinting into two categories, basic and advanced. Basic fingerprinting, which follows the list of APIs identified by Zhang~\etal{} in ~\cite{zhang_crawlphish_2021} was present in 80\% of the clusters (over 300,000 pages), and Advance fingerprinting (measured by at least 5 APIs idenfied by Su~\etal{} in ~\cite{jsufp}) show up in 70\% of the clusters. Together, 85\% of clusters (9,572 clusters, 313,212 pages) exhibit some kind of fingerprinting.
\input{figures/obfuscation_tactics.tex}

\paperFinding{Fingerprint exfiltration, obfuscation, and bot detection are widespread phishing clusters} While fingerprinting is near universal, we find that a smaller fraction of the clusters employ obfuscation, fingerprint exfiltration, and timing for bot detection. We present the breakdown of all these techniques in Table~\ref{tab:obfuscaiton}. We find that 22\% of clusters call out use \texttt{Performance.now} in conjunction with setTimeout, enabling delta time measurement for bot detection. 46\% of pages call at least five advanced fingerprinting APIs, followed by an exfiltration-related API.

31\% of clusters (2,395) employ some form of obfuscation. A full breakdown of different obfuscation forms is in Table~\ref{tab:obfuscaiton} and as we can see, eval and Base64 encoding were the most popular ways of obfuscation. Despite the best recommendations~\cite{EvalJavaScriptMDN2025} to web developers, JavaScript's eval function remains a favorite for obfuscation and evasions~\cite{fv8-sec24}. Sometimes, a script is executed via `eval()', which evaluates yet another script itself; we measure this phenomenon as a level in \textbf{eval-depth}. We find that 48 clusters have pages that go to eval-depth 3. However, this seems to be a side-effect of embedding the phishing pages (mainly ones targeting Facebook) in Blogger.com pages.


\input{figures/ipinfo.tex}

\paperFinding{While rare, client-side IP reputation checks are present across multiple clusters} While only present in 504 clusters (19,869 pages), we identify 15 unique IP reputation APIs used by phishing pages as soon as the page loads. We present a full breakdown in Table~\-\ref{tab:ip_rep}. While not the most popular, \textit{api.ipregistry.co} presents an interesting case study, as it enables the identification of educational networks. Manual examination of pages from these clusters reveals snippets similar to Figure~\ref{fig:ip_example}
\input{figures/ip_apis.tex}
\input{figures/timeline.tex}

\paperFinding{Pop-UP APIs are declining} We see only 104 clusters (1,323 pages) call out to pop-up requesting APIs. Among these, Geolocation.getCurrentPosition (55 clusters) was the most popular. While requiring a pop-up to interact with, this API can also play a crucial role in cloaking, as any VPN or proxy does not mask the results. 

We observe a smaller fraction of the ecosystem (16 clusters, 148 pages) than ~\cite{crawlphish} employs this cloaking technique, especially when it comes to triggering a notification pop-up to verify user interaction. This could be a result of Firefox, citing low engagement with the notifications, started requiring user interaction to trigger the popup~\cite{mozillaRestrictingNotificationPermission2019} at the end of November 2019, when crawlphish's data collection ended. Chrome has since discussed modifying the notification API to make the request less disruptive to the user experience~\cite{IntroducingQuieterPermission}. The lack of pop-up requests could also be explained by our \textbf{Finding-9} regarding usage of Fetch and XMLHttpRequest or by the overwhelming amount of the pages (67\%) registering at least one HTMLElement event handler, which would be classified as a \textit{Click-through} by Crawlphish's taxonomy. We report a full breakdown of APIs related to the Crawlphish categorization of client-side cloaking in Table~\ref{tab:crawlphish}.  

\paperFinding{Mouse Detection API calls and Cloudflare Turnstile embedding are specific to a small group of clusters}
While supported by most modern browsers, we see a very rare use of Mouse Detection APIs. Only 35 clusters employ mouse detection-related APIs. Two of these clusters\footnote{Split due to infrastructure inability causing crashes in early crawls} are from an open-source phishing kit, leveraging botguard, are from a public GitHub repository, which was last updated in 2017\footnote{\url{https://github.com/ashanahw/Gmail_Phishing}}. We see these clusters deploy across 17 unique domains, starting from 2023-10-07 all the way to 2024-07-19. \textbf{7 clusters (181 pages)} embed a Cloudflare turnstile check in their page; some of these domains are not hosted on Cloudflare. It should be noted that in the case of redirection, while we discussed the presence of WebAssembly-based captchas for bot detection, embedding a Cloudflare Turnstile check allows the phishing kit authors to offload bot detection to a well-established ecosystem. Recently, analyses have identified high-value phishing kits with this behavior~\cite{Tycoon}. 

\input{figures/AllTechniques.tex}
Figure~\ref{fig:AllTechniques} shows the confusion matrix between the techniques we enumerated and the size of the clusters. We see no noticeable difference between small and large clusters when it comes to cluster size, with the exception of a higher percentage of large clusters using client-side IP checks. We also observe that pages that employ experimental APIs also tend to include a deprecated API call, which is in line with their usage for browser fingerprinting. 

\paperFinding{The phishing ecosystem consists of clusters that utilize both cutting-edge, experimental browser APIs, and extremely deprecated APIs} We find 421 clusters (8,270 pages) that utilize \textit{NavigatorUAData.getHighEntropyValues} for fingerprinting and \textit{Keyboard.lock} to restrict user input, APIs not fully supported by Firefox and Safari. We identified 10 clusters across 4,433 pages that used \textit{Scheduling.isInputPending}, however, upon closer inspection, these were not pages using a novel kit, but rather pages that used Google Sheets to construct their landing page. On the other hand, 25\% of the clusters spanning (47,001) pages use a deprecated API. 
While not experimental, WebAssembly is still a relatively modern web practice. We find a total of 199 clusters (5,107 pages) that use WebAssembly related APIs. Upon manual inspection of 33 unique WASM modules present on these pages, we identify bot-detection, in most cases, by using FriendlyCaptcha, as the most common use case for WebAssembly in phishing.