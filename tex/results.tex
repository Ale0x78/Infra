 \section{Results} 
\label{sec:results}

\subsection{Kit identification}
\input{figures/vt_vs.tex}
\paperFinding{In majority of the cases, pages that execute at least two distinct browser APIs can be related to one another based on the underlying phishing kit; as the sophistication of the page grows, so does the accuracy of the clustering} We find that clustering all pages that execute at least two browser API, yields an FMI based accuracy of 0.92. Figure~\ref{fig:vs_gt} shows the V-Measure and FMI for our clusters as we increase the requirement of distinct APIs in the execution trace. We ultimately chose four browser APIs as the requirement for further experimentation on the ground truth data, as they provided a good tradeoff between V-measure and the number of pages used. For the unlabeled pages, we used 8 APIs, as they provided zero malformed clusters on our ground truth data (clusters with no API sets in common).
Clustering pages from \totalKitPages{} pages across \totalNumberOfKitFamilies{} kits, yields \totalKitClusters{} clusters. Evaluating these clusters against the ground truth labels for each page, we find that our clusters have an FMI-based accuracy of \gtFMI{} and a V-measure of \gtVS{} (with completeness and homogeneity scores of \gtcompleteness{} and \gthomogeneity{} respectively).

Pages from kit ``2e94aff28a2c'' targeting WellsFargo Fargo make up 24\% of the ground truth dataset. We evaluate the clustering on a re-balanced dataset, where we sample 104 pages (the same number of pages as the 2nd most popular kit) instead of using all 1,073. This reduces our FMI score to 0.69 (V-Measure of 0.9), outperforming past page differentiation attempts.

\input{figures/static}
\paperFinding{Browser API sets better separate phishing kits than script hashes, even when we include scripts dynamically extracted from eval statements} We use sha256 hashes of executed scripts as features into HDBSCAN to compare against our approach. Table~\ref{tab:static} shows that browser API sets maintain a higher accuracy than SHA256 hashes of scripts, even for scripts that are extracted out of eval statements, and would require dynamic or static analysis to acquire.

\paperFinding{DOM APIs and property reads are a valuable signal in kit differentiation} We find that removing DOM-related APIs or property reads out of consideration drastically reduces the number of pages we can consider for ground truth evaluation without increasing our overall accuracy. The key insight here is that these APIs signal particular choices the kit author made about the UI library they used, if they chose to hide the DOM as an evasion, or not draw it to begin, or which selectors, IDs, or classes they prefer to use. Clustering evaluation metrics for the ground truth dataset with DOM, SVG, and CSS APIs removed results in an FMI of 0.93 and a V-measure of 0.86. When all property reads were removed, we saw an FMI and V-measure of 0.93 and 0.85, respectively. In both cases, we can cluster fewer pages and thus identify fewer kits, but we do not see a significant improvement in clustering accuracy.

\subsection{Clusters in the wild}
\paperFinding{ 69\% of clusters contain URLs only marked by a single target brand by our threat intel sources\footnote{We did not include clusters in this count that had no brand-labeled URLs in them}} This phenomenon is observed in the ground truth dataset, as URLs for 90\% of the kits were targeting a singular brand. Together, this provides strong circumstantial evidence that deployed kits are increasingly becoming brand-specific. 1,253 clusters (19\%) of the clusters had two brand labels. However, the most popular combination of these was "Meta/Facebook", "Facebook/Instagram", "National Police Agency JAPAN/Facebook", and "holiganbet/jojobet", keeping the parent organization of the target the same in the majority of the cases. Manual examination of clusters with "National Police Agency JAPAN/Facebook" brand labels revealed shopping pages in Japanese to be mismarked with that label from our data feeds. The cluster with the most diverse set of brand labels had 14 unique brand labels, which was a cluster with 12,467 pages with simple sign-in pages that exfiltrated information using client-side registered event listeners. Furthermore, we find that 16,100 pages (3\% of the pages observed spanning 313 clusters) come from phishing kits collected using KitPhisher; however, we could not pull the kit from the URL in all pages. Figure~\ref{fig:brands} shows a histogram of the unique brand labels observed per cluster.
\input{figures/brands}
% \paperFinding{Top 50 clusters by page count, account for over 40\% of the phishing traffic observed}
% \totalFromTop{} pages are sorted into one of the 50 top clusters. The 10 clusters by page count are 20.8\% of the total pages alone. We provide a breakdown of these clusters along with manual labeling of what campaigns they correspond to in Figure~\ref{fig:top_10_clusters}. We note that one of the clusters, which we labeled dynamically generated, turned out to be a noisy cluster of simple pages that dynamically generate the page using \js{}, without any sophisticated client-side behavior, based on their browser API traces. The E-commerce cluster shown in Figure~\ref{fig:top_10_clusters} has a significant seasonality, with an auto-correlation function showing significance at lags 7,14, and 21; meaning the appearance of the clusters on the feeds happens every week. However, further investigation showed that the majority of seasonal clusters are similar e-commerce phishing clusters, with vastly different dynamic behavior, allowing us to conclude that the seasonality in the majority of the clusters is due to regular reporting by threat-intelligence sources to our feeds, and not seasonal deployments of kits.
% \paperFinding{72\% of the clusters (144,695 pages), are only seen for a single month by phishing feeds} Lack of re-emergence for signals either the deployment of throw-away kits, or the possibility that these clusters engage in profiling of phishing feed detectors as described by \cite{acharyaPhishPrintEvadingPhishing2021}. 15\% of the clusters (14,555 pages) we observe are only seen for one day, along with brandless bank pages and a phishing page impersonating the government of Korea. Meanwhile, 1,282 clusters (11\%) have lifetimes longer than 100 days. Some clusters with a lifetime greater than 100 days still only deploy a few pages (less than 1 page every 10 days). We use this as a heuristic to identify 251 clusters 're-emergence' through our observation period.
\subsection{Phishing Techniques across clusters}

\paperFinding{UI interactivity and fingerprinting are a near-universal behavior across clusters} Multi-stage phishing pages are very well documented in prior work, and we find that most clusters (91\%) register a click event listener using JavaScript. Though this could be as simple as submitting credentials using JavaScript, this highlights the need for researchers to augment their crawlers in the future to extract better and more complete execution traces from websites. We split fingerprinting into two categories, basic and advanced. Basic fingerprinting, which follows the list of APIs identified by Zhang~\etal{} in ~\cite{zhangCrawlPhishLargescaleAnalysis2021} was present in 80\% of the clusters (over 300,000 pages), and Advance fingerprinting (measured by at least 5 APIs idenfied by Su~\etal{} in ~\cite{jsufp}) show up in 70\% of the clusters. Together, 85\% of clusters (9,572 clusters, 313,212 pages) exhibit some form of fingerprinting.
\input{figures/obfuscation_tactics.tex}

\paperFinding{Fingerprint exfiltration, obfuscation, and bot detection are widespread across clusters} While fingerprinting is near universal, we find that a smaller fraction of the clusters employ obfuscation, fingerprint exfiltration, and timing for bot detection. Prior work has shown interest in these behaviors\cite{sanchez-rolaRodsLaserBeams2023,fv8-sec24,linPhishSheepClothing2022,zhang_crawlphish_2021}, meaning kits that forgo this may be rudimentary either by negligence or design, to avoid static and dynamic phishing detection based on JavaScript features. Dropping anti-bot detection features has been observed before, with an Office365 phishing kit (dubbed Tycoon2FA), opting to remove CloudFlare Turnstile integration, as it was being used as a feature for detection\cite{Tycoon2FANewEvasion}. 

Another common tactic for bot detection is timing-based checks; this can be done via Browser APIs by calling \texttt{Performance.now} right before and inside of a \texttt{Window.setTimeout} statement to measure the time differential between setting the timeout and its triggering. We find that 22\% of clusters call \texttt{Performance.now} in conjunction with \texttt{setTimeout}.

On the other hand, 31\% of clusters (2,395) employ some form of obfuscation. We present the breakdown of all obfuscation techniques in Table~\ref{tab:obfuscaiton} and as we can see, eval and Base64 encoding were the most popular ways of obfuscation. Despite the best recommendations to web developers to avoid using `eval'~\cite{EvalJavaScriptMDN2025}, JavaScript's eval function remains a favorite for obfuscation and evasions~\cite{fv8-sec24}. Sometimes, a script is executed via `eval()', which evaluates yet another script itself; we measure this phenomenon as a level in \emph{eval-depth}. We find that 48 clusters have pages that go to eval-depth 3. However, this seems to be a side-effect of embedding the phishing pages (mainly ones targeting Facebook) in Blogger.com pages.

\input{figures/ipinfo.tex}

\paperFinding{While rare, client-side IP reputation checks are present across multiple clusters} While only present in 504 clusters (19,869 pages), we identify 15 unique IP reputation APIs used by phishing pages as soon as the page loads. We present a full breakdown in Table~\-\ref{tab:ip_rep}. While not the most popular, \textit{api.ipregistry.co} presents an interesting case study, as it enables the identification of educational networks. Manual examination of pages from these clusters reveals snippets similar to Listing~\ref{fig:ip_example}, which conditionally chooses to redirect away from cloud hosting providers, content delivery networks, and educational networks, like the one we performed the crawls through. However, due to them employing other browser APIs, before the cloaking behavior, we are still able to cluster the pages based on the initial logic of the landing page. 
\input{figures/ip_apis.tex}


\paperFinding{Pop-UP APIs are declining in usage} We see only 104 clusters (1,323 pages) call out to pop-up requesting APIs. Among these, Geolocation.getCurrentPosition (55 clusters) was the most popular. While requiring a pop-up to interact with, this API can also be crucial in cloaking, as any VPN or proxy does not mask the results. 

We observe a smaller fraction of the ecosystem (16 clusters, 148 pages) than \cite{zhangCrawlPhishLargescaleAnalysis2021} employs this cloaking technique, especially when it comes to triggering a notification pop-up to verify user interaction. This could be a result of Firefox, citing low engagement with the notifications, starting to require user interaction to trigger the popup~\cite{mozillaRestrictingNotificationPermission2019} at the end of November 2019, when crawlphish's data collection ended. Chrome has since discussed modifying the notification API to make the request less disruptive to the user experience~\cite{IntroducingQuieterPermission}. The Lack of pop-up requests could also be explained by our \emph{Finding 9} regarding the usage of IP intelligence APIs or by the overwhelming amount of pages (67\%) registering at least one HTMLElement event handler, which would be classified as a \textit{Click-through} by Crawlphish's taxonomy. We report a full breakdown of APIs related to the Crawlphish categorization of client-side cloaking in Table~\ref{tab:crawlphish}.  

\paperFinding{Mouse Detection API calls and Cloudflare Turnstile embedding are specific to a small group of clusters}
While supported by most modern browsers, we see a very rare use of Mouse Detection APIs. Only 35 clusters employ mouse detection-related APIs. Two of these clusters\footnote{Split due to infrastructure inability causing crashes in early crawls} are from an open-source phishing kit, leveraging botguard, and are from a public GitHub repository, which was last updated in 2017\footnote{\url{https://github.com/ashanahw/Gmail_Phishing}}. We see these clusters deploy across 17 unique domains, starting from 2023-10-07 all the way to 2024-07-19. \emph{7 clusters (181 pages)} embed a Cloudflare turnstile check in their page; some domains are not hosted on Cloudflare. It should be noted that in the case of redirection. At the same time, we discussed the presence of WebAssembly-based captchas for bot detection. Embedding a Cloudflare Turnstile check allows the phishing kit authors to offload bot detection to a well-established ecosystem. Recently, analyses have identified high-value phishing kits with this behavior~\cite{Tycoon}. However, subsequent analysis of the same threat actor identified a shift from turnstiles to HTML-Canvas drawn captchas. 

\paperFinding{The phishing ecosystem consists of clusters that utilize both cutting-edge, experimental browser APIs, and extremely deprecated APIs} We find 421 clusters (8,270 pages) that utilize \textit{NavigatorUAData.getHighEntropyValues} for fingerprinting and \textit{Keyboard.lock} to restrict user input, APIs not fully supported by Firefox and Safari. We identified 10 clusters across 4,433 pages that used \textit{Scheduling.isInputPending}, however, upon closer inspection, these were not pages using a novel kit, but instead pages that used Google Sheets to construct their landing page. On the other hand, 25\% of the clusters spanning (47,001) pages use a deprecated API. 

While not experimental, WebAssembly is still a relatively modern web practice. We find 199 clusters (5,107 pages) that use WebAssembly related APIs. Upon manual inspection of 33 unique WASM modules on these pages, we identify bot-detection, in most cases, by using FriendlyCaptcha, as the most common use case for WebAssembly in phishing.

Figure~\ref{fig:AllTechniques} shows the confusion matrix between the techniques we enumerated and the size of the clusters. We see no noticeable difference in techniques regarding cluster size, except for a higher percentage of large clusters using client-side IP checks. We also observe that pages that employ experimental APIs also tend to include a deprecated API call, which aligns with their usage for browser fingerprinting, rather than novel cloaking logic. 